# ===----------------------------------------------------------------------=== #
#
# This file is Modular Inc proprietary.
#
# ===----------------------------------------------------------------------=== #
# REQUIRES: nvptx_backend
# RUN: %mojo -debug-level full %s | FileCheck %s

from sys.info import triple_is_nvidia_cuda
from gpu import ThreadIdx
from gpu.nvidia_host import _compile_nvptx_asm


fn kernel(x: Int) -> Int:
    return ThreadIdx.x()


fn parametric[f: fn (Int) -> Int]() -> Int:
    return f(42)


fn main():
    # CHECK: Generated by LLVM NVPTX Back-End
    # CHECK: .visible .entry _test_compile_nvptx_kernel
    print(_compile_nvptx_asm[fn (Int) -> Int, kernel]())
    # CHECK: Generated by LLVM NVPTX Back-End
    # CHECK: .visible .entry _test_compile_nvptx_parametric_fn_
    print(_compile_nvptx_asm[fn () -> Int, parametric[kernel]]())
